import{_ as c,c as m,b as u,o as a,a as e,t as n,F as l,r as d,w as p,v}from"./index-iuENcq69.js";const h={data(){return{poem:null,isFavorite:!1,newComment:""}},async created(){await this.fetchPoem()},methods:{async fetchPoem(){this.poem=await getPoemById(this.$route.params.id)},async toggleFavorite(){await toggleFavorite("current-user-id",this.poem.id),this.isFavorite=!this.isFavorite},async submitComment(){if(!this.newComment.trim())return;await addComment("current-user-id",this.poem.id,this.newComment),this.newComment="",await this.fetchPoem()},formatDate(i){return new Date(i).toLocaleString()}}},_={key:0,class:"poem-detail"},f={class:"poem-header"},g={class:"author"},w={class:"poem-content"},C={class:"poem-meta"},y={class:"annotations"},b={class:"comments"},F={class:"comment-form"},k={class:"comment-list"},D={class:"user"},I={class:"content"},P={class:"time"};function x(i,s,B,V,o,r){return o.poem?(a(),m("div",_,[e("button",{class:"back-btn",onClick:s[0]||(s[0]=t=>i.$router.go(-1))},"返回"),e("div",f,[e("h1",null,n(o.poem.title),1),e("p",g,n(o.poem.authors?.name),1)]),e("div",w,[e("pre",null,n(o.poem.content),1)]),e("div",C,[e("span",null,n(o.poem.dynasty)+"·"+n(o.poem.genre),1),e("button",{class:"favorite-btn",onClick:s[1]||(s[1]=(...t)=>r.toggleFavorite&&r.toggleFavorite(...t))},n(o.isFavorite?"已收藏":"收藏"),1)]),e("div",y,[s[4]||(s[4]=e("h3",null,"注释",-1)),(a(!0),m(l,null,d(o.poem.annotations,t=>(a(),m("p",{key:t.id},n(t.content),1))),128))]),e("div",b,[s[5]||(s[5]=e("h3",null,"评论",-1)),e("div",F,[p(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=t=>o.newComment=t),placeholder:"写下你的评论..."},null,512),[[v,o.newComment]]),e("button",{onClick:s[3]||(s[3]=(...t)=>r.submitComment&&r.submitComment(...t))},"提交")]),e("div",k,[(a(!0),m(l,null,d(o.poem.comments,t=>(a(),m("div",{key:t.id,class:"comment"},[e("div",D,n(t.users?.username||"匿名用户"),1),e("div",I,n(t.content),1),e("div",P,n(r.formatDate(t.created_at)),1)]))),128))])])])):u("",!0)}const N=c(h,[["render",x],["__scopeId","data-v-12d02810"]]);export{N as default};
